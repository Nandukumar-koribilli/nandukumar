<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop Yield Predictor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        .header {
            display: flex;
            align-items: center;
            display: flex;
            align-items: center;
            padding: 10px 20px;
            background-color: rgb(255, 255, 255);
            border-bottom: 1px solid #ffffff;
            border-radius: 20px;
        }

        .logo {
            max-width: 120px; /* Adjust as needed based on your logo size */
            height: auto;
            margin-right: 20px; /* Space between logo and name */
        }

        .college-name {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            flex-grow: 1; /* Makes the name expand to center itself */
            text-align: center;
        }

        .container {
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #333;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        label {
            font-weight: bold;
        }

        input, select {
            padding: 8px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
        }

        button {
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #218838;
        }

        .result {
            margin-top: 20px;
            font-size: 18px;
            text-align: center;
        }

        /* Styles for the searchable dropdown */
        .dropdown-container {
            position: relative;
        }

        #cropTypeInput {
            width: 100%;
        }

        #cropList {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 10;
        }

        #cropList div {
            padding: 8px;
            cursor: pointer;
        }

        #cropList div:hover {
            background-color: #f0f0f0;
        }

        #cropList .category {
            font-weight: bold;
            background-color: #e9ecef;
            cursor: default;
        }

        .footer {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            border-top: 2px solid #28a745;
            margin-top: 30px;
            font-size: 18px;
            color: #555;
            line-height: 1.6;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
        } 

        
    </style>
</head>
<body>
    <div class="header">
        <img src="gvp logo.png" alt="Gayatri Vidya Parishad College Logo" class="logo">
        <div class="college-name">GAYATRI VIDYA PARISHAD COLLEGE FOR DEGREE AND PG COURSES (AUTONOMOUS)</div>
    </div>

    <div class="container">
        <h1>Crop Yield Predictor</h1>
        <form id="predictionForm">
            <label for="cropTypeInput">Crop Type:</label>
            <div class="dropdown-container">
                <input type="text" id="cropTypeInput" placeholder="Search crop type..." required>
                <div id="cropList">
                    <div class="category">Grains</div>
                    <div data-value="wheat">Wheat</div>
                    <div data-value="corn">Corn</div>
                    <div data-value="rice">Rice</div>
                    <div data-value="barley">Barley</div>
                    <div data-value="oats">Oats</div>
                    <div data-value="brown_rice">Brown Rice</div>
                    <div data-value="white_rice">White Rice</div>
                    <div data-value="rye">Rye</div>
                    <div data-value="millet">Millet</div>
                    <div class="category">Vegetables</div>
                    <div data-value="potatoes">Potatoes</div>
                    <div data-value="onion">Onion</div>
                    <div data-value="tomatoes">Tomatoes</div>
                    <div data-value="cabbage">Cabbage</div>
                    <div data-value="bean">Bean</div>
                    <div data-value="eggplant">Egg Plants</div>
                    <div data-value="cauliflower">Cauliflower</div>
                    <div data-value="cucumbers">Cucumbers</div>
                    <div data-value="frozen_peas">Frozen Peas</div>
                    <div data-value="garlic">Garlic</div>
                    <div data-value="okra">Okra</div>
                    <div data-value="beetroot">Beetroot</div>
                    <div data-value="green_pepper">Green Pepper</div>
                    <div data-value="baby_spinach">Baby Spinach</div>
                    <div data-value="cloves">Cloves</div>
                    <div data-value="cucurbits">Cucurbits</div>
                    <div data-value="carrots">Carrots</div>
                    <div data-value="lettuce">Lettuce</div>
                    <div class="category">Fruits</div>
                    <div data-value="mango">Mango</div>
                    <div data-value="banana">Banana</div>
                    <div data-value="papaya">Papaya</div>
                    <div data-value="guava">Guava</div>
                    <div data-value="pineapple">Pineapple</div>
                    <div data-value="jackfruit">Jackfruit</div>
                    <div data-value="custard_apple">Custard Apple</div>
                    <div data-value="sapota">Sapota</div>
                    <div data-value="coconut">Coconut</div>
                    <div data-value="watermelon">Watermelon</div>
                    <div data-value="muskmelon">Muskmelon</div>
                    <div data-value="blackberry">Blackberry</div>
                    <div data-value="gooseberry">Gooseberry</div>
                    <div data-value="litchi">Litchi</div>
                    <div data-value="avocado">Avocado</div>
                    <div data-value="orange">Orange</div>
                    <div data-value="lemon">Lemon</div>
                    <div data-value="apple">Apple</div>
                    <div data-value="grapes">Grapes</div>
                    <div data-value="pomegranate">Pomegranate</div>
                    <div data-value="peach">Peach</div>
                    <div data-value="plum">Plum</div>
                    <div data-value="apricot">Apricot</div>
                    <div data-value="mulberry">Mulberry</div>
                    <div data-value="strawberries">Strawberries</div>
                    <div data-value="dragon_fruit">Dragon Fruit</div>
                    <div data-value="kiwi_fruit">Kiwi Fruit</div>
                    <div class="category">Legumes</div>
                    <div data-value="soybeans">Soybeans</div>
                    <div data-value="bean">Bean</div>
                </div>
            </div><br>

            <label for="season">Season:</label>
            <select id="season" required>
                <option value="summer">Summer</option>
                <option value="winter">Winter</option>
                <option value="autumn">Autumn</option>
                <option value="spring">Spring</option>
                <option value="monsoon">Monsoon</option>
            </select><br>

            <label for="soilType">Soil Type:</label>
            <select id="soilType" required>
                <option value="loam">Loam Soil</option>
                <option value="clay">Clay Soil</option>
                <option value="sandy">Sandy Soil</option>
                <option value="silty">Silty Soil</option>
                <option value="chalk">Chalk Soil</option>
                <option value="peat">Peat Soil</option>
            </select><br>

            <label for="soilQuality">Soil Quality (1-10):</label>
            <input type="number" id="soilQuality" min="1" max="10" required><br>

            <label for="landArea">Land Area (hectares):</label>
            <input type="number" id="landArea" step="0.1" required><br>

            <label for="state">State:</label>
            <select id="state" required>
                <option value="andhra_pradesh">Andhra Pradesh</option>
                <option value="arunachal_pradesh">Arunachal Pradesh</option>
                <option value="assam">Assam</option>
                <option value="bihar">Bihar</option>
                <option value="chhattisgarh">Chhattisgarh</option>
                <option value="goa">Goa</option>
                <option value="gujarat">Gujarat</option>
                <option value="haryana">Haryana</option>
                <option value="himachal_pradesh">Himachal Pradesh</option>
                <option value="jharkhand">Jharkhand</option>
                <option value="karnataka">Karnataka</option>
                <option value="kerala">Kerala</option>
                <option value="madhya_pradesh">Madhya Pradesh</option>
                <option value="maharashtra">Maharashtra</option>
                <option value="manipur">Manipur</option>
                <option value="meghalaya">Meghalaya</option>
                <option value="mizoram">Mizoram</option>
                <option value="nagaland">Nagaland</option>
                <option value="odisha">Odisha</option>
                <option value="punjab">Punjab</option>
                <option value="rajasthan">Rajasthan</option>
                <option value="sikkim">Sikkim</option>
                <option value="tamil_nadu">Tamil Nadu</option>
                <option value="telangana">Telangana</option>
                <option value="tripura">Tripura</option>
                <option value="uttar_pradesh">Uttar Pradesh</option>
                <option value="uttarakhand">Uttarakhand</option>
                <option value="west_bengal">West Bengal</option>
            </select><br>

            <button type="submit">Predict Yield</button>
        </form>
        <div id="result" class="result"></div>
    </div>

    <footer class="footer">
        This project is done by Nandu Kumar <br>
        <div style="margin-top: 10px;">
            <a href="https://github.com/nandu9980" target="_blank">
                <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" 
                     alt="GitHub" 
                     style="width: 40px; height: 40px; vertical-align: middle; margin: 0 10px;">
            </a>
            <a href="https://www.linkedin.com/in/nandukumar-koribilli-062ba42a2/" target="_blank">
                <img src="https://content.linkedin.com/content/dam/me/business/en-us/amp/brand-site/v2/bg/LI-Bug.svg.original.svg" 
                     alt="LinkedIn" 
                     style="width: 40px; height: 45px; vertical-align: middle; margin: 0 10px;">
            </a>
        </div>
    </footer>

    <script>
        // Handle the searchable dropdown
        const cropInput = document.getElementById('cropTypeInput');
        const cropList = document.getElementById('cropList');
        const cropItems = cropList.querySelectorAll('div:not(.category)');
        let selectedCrop = null;

        // Show dropdown when input is focused
        cropInput.addEventListener('focus', () => {
            cropList.style.display = 'block';
            filterCrops();
        });

        // Hide dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!cropInput.contains(e.target) && !cropList.contains(e.target)) {
                cropList.style.display = 'none';
            }
        });

        // Filter crops based on input
        cropInput.addEventListener('input', filterCrops);

        function filterCrops() {
            const searchValue = cropInput.value.toLowerCase();
            cropItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                const category = item.previousElementSibling?.classList.contains('category') 
                    ? item.previousElementSibling 
                    : item.previousElementSibling?.previousElementSibling;
                
                if (text.includes(searchValue)) {
                    item.style.display = 'block';
                    if (category) category.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });

            // Show/hide categories based on visible items
            const categories = cropList.querySelectorAll('.category');
            categories.forEach(category => {
                const nextItems = [];
                let sibling = category.nextElementSibling;
                while (sibling && !sibling.classList.contains('category')) {
                    nextItems.push(sibling);
                    sibling = sibling.nextElementSibling;
                }
                category.style.display = nextItems.some(item => item.style.display === 'block') ? 'block' : 'none';
            });
        }

        // Select a crop when clicked
        cropItems.forEach(item => {
            item.addEventListener('click', () => {
                selectedCrop = item.getAttribute('data-value');
                cropInput.value = item.textContent;
                cropList.style.display = 'none';
            });
        });

        // Form submission
        document.getElementById('predictionForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!selectedCrop) {
                alert('Please select a crop type.');
                return;
            }

            const cropType = selectedCrop;
            const season = document.getElementById('season').value;
            const soilType = document.getElementById('soilType').value;
            const soilQuality = document.getElementById('soilQuality').value;
            const landArea = document.getElementById('landArea').value;
            const state = document.getElementById('state').value;

            const data = { cropType, season, soilType, soilQuality, landArea, state };

            try {
                const response = await fetch('http://localhost:5000/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const result = await response.json();
                document.getElementById('result').innerHTML = `
                    <p><strong>Crop Type:</strong> ${result.cropType}</p>
                    <p><strong>Duration:</strong> ${result.duration} months</p>
                    <p><strong>Predicted Yield:</strong> ${result.yield} tons/hectare</p>
                    <p><strong>Market Price:</strong> ₹${result.marketPrice} per ton</p>
                    <p><strong>Profit or Loss:</strong> ₹${result.profitOrLoss}</p>
                `;
            } catch (error) {
                document.getElementById('result').innerText = 'Error predicting yield. Please try again.';
                console.error('Error:', error);
            }
        });
    </script>
</body>
</html>